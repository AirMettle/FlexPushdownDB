from s3filter.util.heap import MaxHeap, MinHeap, HeapTuple
from s3filter.op.sort import SortExpression

__author__ = 'Abdurrahman Ghanem <abghanem@qf.org.qa>'

tuples = [
    ['1125379', '137079', '2106', '3', '10', '11160.70', '0.07', '0.06', 'N', 'O', '1998-01-31', '1998-02-06', '1998-02-16', 'DELIVER IN PERSON', 'RAIL', 'osits are carefully i'],
    ['1125348', '14753', '7255', '2', '10', '16677.50', '0.09', '0.01', 'N', 'O', '1995-12-26', '1996-02-05', '1996-01-13', 'TAKE BACK RETURN', 'MAIL', ' packages nod fluffily. furiou'],
    ['1125381', '11487', '3989', '2', '8', '11187.84', '0.10', '0.01', 'A', 'F', '1994-06-18', '1994-06-17', '1994-06-20', 'NONE', 'REG AIR', 'ck deposits haggle carefully re'],
    ['1125380', '67110', '2123', '1', '8', '8616.88', '0.00', '0.04', 'R', 'F', '1994-01-26', '1993-12-14', '1994-01-28', 'COLLECT COD', 'RAIL', ' enticing packages use slyly alo'],
    ['1125383', '98810', '6338', '5', '38', '68734.78', '0.06', '0.04', 'R', 'F', '1992-09-25', '1992-08-25', '1992-10-07', 'TAKE BACK RETURN', 'MAIL', 'ly special requests wake. blith'],
    ['1125382', '190144', '5183', '2', '37', '45663.18', '0.08', '0.06', 'N', 'O', '1997-10-21', '1997-12-14', '1997-10-28', 'NONE', 'TRUCK', 'n requests about the furious'],
    ['1125349', '77143', '2158', '2', '34', '38084.76', '0.08', '0.06', 'R', 'F', '1994-06-15', '1994-06-19', '1994-07-09', 'TAKE BACK RETURN', 'AIR', 'in furiously slyly ironic pains. sp'],
    ['1125351', '39', '7540', '1', '34', '31927.02', '0.04', '0.01', 'A', 'F', '1994-11-09', '1994-10-03', '1994-11-25', 'TAKE BACK RETURN', 'TRUCK', ' above the pending ac'],
    ['1125378', '164797', '7314', '7', '33', '61439.07', '0.03', '0.01', 'N', 'O', '1997-02-26', '1997-03-04', '1997-03-17', 'DELIVER IN PERSON', 'MAIL', 'eodolites-- special deposits'],
    ['1125379', '174641', '4642', '5', '32', '54900.48', '0.09', '0.08', 'N', 'O', '1998-02-12', '1998-01-25', '1998-03-13', 'DELIVER IN PERSON', 'MAIL', 'nusual packages. ca'],
    ['1125378', '7551', '52', '3', '32', '46673.60', '0.02', '0.05', 'N', 'O', '1997-01-22', '1997-02-19', '1997-01-25', 'NONE', 'TRUCK', ' alongside of the fur'],
    ['1125379', '80346', '2855', '4', '32', '42442.88', '0.04', '0.02', 'N', 'O', '1998-03-18', '1998-02-19', '1998-04-06', 'NONE', 'AIR', 'inal account'],
    ['1125408', '134406', '1946', '2', '5', '7202.00', '0.01', '0.00', 'N', 'O', '1997-07-05', '1997-05-15', '1997-07-18', 'NONE', 'REG AIR', 'n, regular accounts: notornis i'],
    ['1125381', '51960', '1961', '3', '5', '9559.80', '0.04', '0.02', 'A', 'F', '1994-07-31', '1994-05-16', '1994-08-19', 'NONE', 'TRUCK', 'nding sheaves use alongside o'],
    ['1125351', '41818', '6827', '2', '5', '8799.05', '0.02', '0.01', 'R', 'F', '1994-09-26', '1994-10-22', '1994-09-29', 'DELIVER IN PERSON', 'RAIL', ' carefully spe'],
    ['1125376', '187842', '7843', '1', '4', '7719.36', '0.10', '0.08', 'R', 'F', '1993-03-26', '1993-02-26', '1993-04-15', 'COLLECT COD', 'RAIL', 'ithely. blithely regul'],
    ['1125383', '28792', '3797', '4', '3', '5162.37', '0.01', '0.06', 'R', 'F', '1992-07-28', '1992-08-17', '1992-08-26', 'DELIVER IN PERSON', 'FOB', 'furiously bold platelets wake furiously'],
    ['1125350', '144164', '4165', '4', '1', '1208.16', '0.06', '0.04', 'R', 'F', '1994-03-01', '1994-02-15', '1994-03-11', 'NONE', 'RAIL', 'ithely unusual dolphins run quickly si'],
    ['1125350', '92732', '7751', '3', '31', '53466.63', '0.08', '0.08', 'R', 'F', '1993-12-29', '1994-03-02', '1994-01-03', 'NONE', 'AIR', 'kly bold requests are carefully r'],
    ['1125348', '140957', '5986', '4', '31', '61936.45', '0.01', '0.01', 'N', 'O', '1996-02-21', '1996-03-04', '1996-02-26', 'DELIVER IN PERSON', 'MAIL', 'out the carefully silent'],
    ['1125409', '86723', '4248', '2', '28', '47872.16', '0.07', '0.06', 'A', 'F', '1992-08-08', '1992-09-24', '1992-08-14', 'DELIVER IN PERSON', 'MAIL', ' bold deposits. '],
    ['1125383', '155985', '8501', '1', '27', '55106.46', '0.10', '0.07', 'R', 'F', '1992-10-31', '1992-10-05', '1992-11-20', 'COLLECT COD', 'AIR', 'ly special excuses affi'],
    ['1125382', '148853', '3882', '4', '26', '49448.10', '0.04', '0.02', 'N', 'O', '1998-02-10', '1997-11-20', '1998-02-20', 'COLLECT COD', 'SHIP', 'bout the express packages-- slyly fin'],
    ['1125381', '83760', '3761', '4', '16', '27900.16', '0.00', '0.08', 'R', 'F', '1994-05-27', '1994-05-12', '1994-06-26', 'DELIVER IN PERSON', 'REG AIR', 'sometimes even dependencies haggle a'],
    ['1125381', '1322', '8823', '1', '15', '18349.80', '0.09', '0.02', 'A', 'F', '1994-05-16', '1994-06-22', '1994-06-12', 'DELIVER IN PERSON', 'TRUCK', 'usly ironic instructions.'],
    ['1125348', '137987', '3014', '3', '14', '28349.72', '0.04', '0.05', 'N', 'O', '1996-01-11', '1996-03-14', '1996-01-14', 'DELIVER IN PERSON', 'FOB', 'ead of the reg'],
    ['1125376', '54869', '7375', '5', '13', '23710.18', '0.02', '0.05', 'R', 'F', '1993-03-28', '1993-01-28', '1993-04-01', 'NONE', 'FOB', 'y final packages across the furiousl'],
    ['1125348', '60513', '514', '5', '12', '17682.12', '0.07', '0.06', 'N', 'O', '1996-02-02', '1996-02-29', '1996-02-19', 'TAKE BACK RETURN', 'SHIP', 'ts according to the special deposits'],
    ['4875011', '187563', '7564', '3', '50', '82528.00', '0.09', '0.07', 'N', 'O', '1998-04-15', '1998-03-03', '1998-05-14', 'TAKE BACK RETURN', 'AIR', 'r excuses. quickly pending requests '],
    ['1125377', '155069', '100', '1', '47', '52830.82', '0.08', '0.02', 'R', 'F', '1992-05-16', '1992-04-13', '1992-05-25', 'TAKE BACK RETURN', 'REG AIR', 'sleep carefully final req'],
    ['1125382', '137250', '9764', '3', '44', '56639.00', '0.05', '0.08', 'N', 'O', '1997-12-22', '1997-11-21', '1998-01-18', 'TAKE BACK RETURN', 'TRUCK', 'he unusual accou'],
    ['1125376', '60354', '7873', '3', '42', '55202.70', '0.03', '0.04', 'A', 'F', '1993-01-18', '1993-01-30', '1993-02-11', 'DELIVER IN PERSON', 'RAIL', ' deposits cajo'],
    ['1125349', '91931', '4441', '1', '42', '80763.06', '0.03', '0.06', 'R', 'F', '1994-07-10', '1994-05-18', '1994-07-21', 'TAKE BACK RETURN', 'FOB', '. furiously unusual'],
    ['1125376', '160318', '5351', '4', '41', '56510.71', '0.09', '0.08', 'A', 'F', '1993-03-22', '1993-01-17', '1993-04-17', 'COLLECT COD', 'TRUCK', 'ts wake sl'],
    ['1125383', '99092', '1602', '3', '41', '44734.69', '0.09', '0.02', 'A', 'F', '1992-09-25', '1992-09-20', '1992-10-07', 'TAKE BACK RETURN', 'SHIP', 'p slyly unusual requests. d'],
    ['1125378', '105624', '3155', '4', '40', '65184.80', '0.06', '0.03', 'N', 'O', '1997-01-11', '1997-03-13', '1997-01-18', 'NONE', 'RAIL', 'e slyly according to t'],
    ['1125376', '58837', '1343', '2', '39', '70037.37', '0.01', '0.00', 'R', 'F', '1992-12-09', '1993-02-28', '1992-12-25', 'COLLECT COD', 'REG AIR', '. platelets might use quickly'],
    ['1125350', '19202', '6706', '1', '38', '42605.60', '0.03', '0.07', 'R', 'F', '1993-12-21', '1994-02-15', '1993-12-28', 'DELIVER IN PERSON', 'RAIL', 'ainst the permanently special req'],
    ['1125409', '140411', '5440', '1', '5', '7257.05', '0.09', '0.00', 'R', 'F', '1992-07-11', '1992-08-29', '1992-07-18', 'NONE', 'AIR', 'ckages according to t'],
    ['1125378', '8190', '8191', '5', '26', '28552.94', '0.03', '0.06', 'N', 'O', '1997-02-08', '1997-02-11', '1997-02-11', 'NONE', 'RAIL', 'p against the special, express requests. fi'],
    ['1125350', '114589', '2123', '2', '25', '40089.50', '0.00', '0.05', 'A', 'F', '1994-01-30', '1994-01-18', '1994-02-07', 'TAKE BACK RETURN', 'TRUCK', 'sits boost. ironic, i'],
    ['1125348', '31342', '3846', '6', '23', '29286.82', '0.07', '0.07', 'N', 'O', '1996-02-15', '1996-02-11', '1996-02-25', 'DELIVER IN PERSON', 'FOB', 'ic platelets. furiously express deposits n'],
    ['1125379', '132342', '9882', '1', '23', '31609.82', '0.03', '0.00', 'N', 'O', '1997-12-28', '1998-01-23', '1998-01-04', 'TAKE BACK RETURN', 'MAIL', 'inally ironic packages hinder car'],
    ['1125378', '172308', '2309', '1', '22', '30366.60', '0.06', '0.04', 'N', 'O', '1997-03-08', '1997-02-11', '1997-03-30', 'NONE', 'REG AIR', 'into beans wake blit'],
    ['1125379', '59258', '4269', '2', '21', '25562.25', '0.07', '0.07', 'N', 'O', '1998-03-14', '1998-03-05', '1998-03-20', 'COLLECT COD', 'SHIP', 'kages. permanently regular courts '],
    ['1125408', '155063', '7579', '1', '20', '22361.20', '0.06', '0.07', 'N', 'O', '1997-04-11', '1997-05-10', '1997-04-17', 'NONE', 'AIR', 'inal theodolites. silent t'],
    ['1125348', '128662', '6199', '1', '20', '33813.20', '0.07', '0.02', 'N', 'O', '1996-04-15', '1996-02-27', '1996-05-05', 'DELIVER IN PERSON', 'REG AIR', 'osits about the pinto'],
    ['1125382', '126245', '1270', '1', '19', '24153.56', '0.00', '0.08', 'N', 'O', '1997-11-24', '1997-11-18', '1997-11-26', 'TAKE BACK RETURN', 'FOB', 'sits. slyly special r'],
    ['1125383', '31029', '1030', '2', '18', '17280.36', '0.10', '0.05', 'A', 'F', '1992-11-01', '1992-08-16', '1992-11-10', 'COLLECT COD', 'AIR', 'efully regu'],
    ['1125378', '169823', '7372', '2', '1', '1892.82', '0.05', '0.06', 'N', 'O', '1997-01-31', '1997-03-02', '1997-02-04', 'COLLECT COD', 'SHIP', 'y alongside of the'],
]

field_names = ['_0', '_1', '_2', '_3', '_4', '_5', '_6', '_7', '_8', '_9', '_10', '_11', '_12', '_13', '_14', '_15']


def test_max_heap():
    print('maxheap')
    sort_exp = SortExpression('_4', int, 'DESC', 'l_quantity')
    heap = MaxHeap(10)
    for t in tuples:
        ht = HeapTuple(t, field_names, sort_exp)
        heap.push(ht)

    for t in heap.get_all_items(sort=True):
        print(t.tuple)


def test_min_heap():
    print('\n\n\nminheap')
    sort_exp = SortExpression('_4', int, 'DESC', 'l_quantity')
    heap = MinHeap(10)
    for t in tuples:
        ht = HeapTuple(t, field_names, sort_exp)
        heap.push(ht)

    for t in heap.get_all_items(sort=True):
        print(t.tuple)


# if __name__ == "__main__":
#     test_max_heap()
#     test_min_heap()
